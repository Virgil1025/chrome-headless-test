$remainingPO = Import-Csv "C:\Users\User\Desktop\BB PO\original.csv";
$output_path = "C:\Users\User\Desktop\BB PO\output3";
$userAgent = Import-Csv "C:\Users\User\Desktop\BB PO\user_agent_new.csv"
While($remainingPO.Count -ne 0){
	$downloadedPO = Get-ChildItem -Path "$($output_path)" -File | ForEach-Object {$_.ToString()};
	$remainingPO = $remainingPO | Where-Object {$_.'file name' + '.pdf' -notin $downloadedPO};
	If ($remainingPO.Count -ne 0){
		Write-Host "$($remainingPO.Count) PO are not downloaded yet, re-download now.";
	}
	else
	{
		Write-Host "Finish!";
	}

	$i = 0;
	foreach($PO in $remainingPO)
	{
		&"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" `
		--headless --disable-gpu `
		--user-agent="$($userAgent[$(Get-Random -Minimum 0 -Maximum $($userAgent.Count - 1))].user_agent)" `
		--run-all-compositor-stages-before-draw `
		--virtual-time-budget=500000 `
		--user-data-dir="C:\Users\User\AppData\Local\Google\Chrome\User Data" `
		--print-to-pdf="$($output_path)\$($PO.'file name').pdf" `
		https://vendorcentral.amazon.com/po/vendor/members/po-mgmt/order?poId=$($PO.'search PO on  amz website');

		$i++;
		$sleepDuration = Get-Random -Minimum 4000 -Maximum 7000;
		Write-Host "$($i) / $($remainingPO.Count) $($PO.'file name') - $($sleepDuration)ms"; 
		sleep -Milliseconds $sleepDuration;
	}
}